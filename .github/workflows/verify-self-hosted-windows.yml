name: Verify Self-Hosted Windows Runner
on:
  workflow_dispatch:

jobs:
  verify-environment:
    runs-on: [self-hosted, windows]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: System Information
        run: |
          Write-Host "=== System Info ==="
          Write-Host "Hostname: $env:COMPUTERNAME"
          Write-Host "User: $env:USERNAME"
          Write-Host "OS: $((Get-CimInstance Win32_OperatingSystem).Caption)"
          Write-Host "Working Directory: $(Get-Location)"

      - name: Check Environment Variables
        run: |
          Write-Host "=== Environment Variables ==="
          Get-ChildItem Env: | Sort-Object Name | Format-Table -AutoSize

      - name: Check Tools
        run: |
          Write-Host "=== Tool Versions ==="
          
          Write-Host "Python:"
          python --version 2>&1 | Write-Host
          
          Write-Host "FFmpeg:"
          try {
            ffmpeg -version | Select-Object -First 1 | Write-Host
          } catch {
            Write-Host "FFmpeg not found or error execution"
          }

          Write-Host "uv:"
          try {
             uv --version 2>&1 | Write-Host
          } catch {
             Write-Host "uv not found. Checking common paths..."
          }

          Write-Host "Chocolatey:"
          choco --version 2>&1 | Write-Host

      - name: Verify Codebase Access
        run: |
          Get-ChildItem -Force
